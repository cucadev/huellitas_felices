doctype html
html(lang="es")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title Mascotas - Huellitas Felices

    // Google Fonts
    link(rel="preconnect" href="https://fonts.googleapis.com")
    link(rel="preconnect" href="https://fonts.gstatic.com" crossorigin)
    link(href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet")

    // Bootstrap CSS
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet")

    // Bootstrap Icons
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css")

    style.
      body {
        font-family: 'Poppins', sans-serif;
        background-color: #F0EDE7;
        color: #333;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }
      main { flex: 1; padding: 20px 0; }

      .dashboard-header {
        width: 100%;
        height: 60px;
        background-color: #762051;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
      }

      .dashboard-header .logo { height: 40px; }
      .dashboard-header .user { color: #fff; font-weight: 200; }

      table { background-color: #fff; }
      th, td { text-align: center; vertical-align: middle; }

      .btn-nuevo {
        background-color: #762051;
        border-color: #762051;
        color: #fff;
      }
      .btn-acciones.editar { background-color: #E49AC3; border-color: #E49AC3; }
      .btn-acciones.eliminar { background-color: #9A4475; border-color: #9A4475; }

      .btn-acciones { margin: 5px 5px; color: #fff; }
      .btn-acciones:hover { opacity: 0.85; }

      footer {
        background-color: #762051;
        color: #fff;
        text-align: center;
        padding: 15px;
      }

  body
    header.dashboard-header
      img.logo(src="/images/logo.png" alt="Logo")
      div.user
        i.bi.bi-person-circle
        |  Ferrazin Nervegna Mayra

    main.container
      .d-flex.justify-content-between.align-items-center.mb-4
        h2 Listado de Mascotas
        a.btn.btn-nuevo(href="/mascotas/nuevo")
          i.bi.bi-plus-lg
          | Nueva Mascota

      if mascotas.length
        table.table.table-striped.table-bordered
          thead
            tr
              th ID
              th Nombre
              th Especie
              th Raza
              th Sexo
              th Edad
              th Peso
              th Primera Consulta
              th Dueño
              th Chip
              th Observaciones
              th Acciones
          tbody
            each mascota in mascotas
              tr
                td= mascota.mascotaId
                td= mascota.nombre
                td= mascota.especie
                td= mascota.raza || "-"
                td= mascota.sexo
                td= mascota.edad + ' años'
                td= mascota.peso ? mascota.peso + ' kg' : '-'
                td= mascota.fechaPrimeraConsulta.toISOString().slice(8,10) + "-" + mascota.fechaPrimeraConsulta.toISOString().slice(5,7) + "-" + mascota.fechaPrimeraConsulta.toISOString().slice(0,4)
                td= mascota.cliente ? mascota.cliente.nombre + " " + mascota.cliente.apellido : "Sin dueño"
                td= mascota.chip || "-"
                td= mascota.observaciones || "-"
                td
                  a.btn.btn-acciones.editar(href=`/mascotas/editar/${mascota._id}`)
                    i.bi.bi-pencil-fill
                  button.btn.btn-acciones.eliminar.btn-eliminar(data-id=mascota._id)
                    i.bi.bi-trash-fill
      else
        p.text-center.mt-4 No hay mascotas registradas.

    script(src="https://cdn.jsdelivr.net/npm/sweetalert2@11")

    script.
      document.querySelectorAll(".btn-eliminar").forEach(btn => {
        btn.addEventListener("click", function () {
          const id = this.getAttribute("data-id");

          Swal.fire({
            title: "¿Eliminar Mascota?",
            text: "Esta acción no se puede deshacer",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#9A4475",
            cancelButtonColor: "#E49AC3",
            confirmButtonText: "Sí, eliminar",
            cancelButtonText: "Cancelar"
          }).then((result) => {
            if (result.isConfirmed) {
              window.location.href = `/mascotas/eliminar/${id}`;
            }
          });
        });
      });


    footer
      | Todos los derechos reservados © 2025 Huellitas Felices

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js")

